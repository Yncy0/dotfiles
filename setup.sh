#!/bin/bash

set -e

echo '       .      .                        ..:-=+***********+=:..                                       
                                ..-+#*+===---:::::::::::--===+**=...          .   .        .        
 .                          .:*#*=-:::::::::::::::::::::::::::::--=*#+..                            
                        .:##=:::::::::::::::::::::::::::::::::::::::::-*#:.                         
                    ..=#*::.::::::::::::::::::::::::::::::::::::::::::::::+#=..    .                
. .               .-**-:::::::::::::::::::::::::::::::::::::::::::::::::::::-+*:.             .     
               ..+*=:::--=+++======--::::::::::::--=++++=--======--::::::::::::=*=.                 
              .+*-:-==-:.............-==-::::-==-:................-==-:::::::::::=*-.       .       
   .         -#=:==-....................:====-.......................:=+-::::::::::=+:.             
       .   .#+-==.........................:.............................-*-::::::::::*=.            
.        .-*-+=.........................-+*+-.............................-+::::::::::=#.           
        .=*=+........................:*-.....=*............................:=-:::::::::-*-.     .   
       .=*==........................=-.      ..*.............................+=::::::::::+=.        
.     .=*==........................=-.        ..*.............................=-::::::::::+=.    .  
     .=#-+............----........-:.          .-+..........:---...............+-::::::::::+-    .  
     -#-+:.........:*%%%%%%+.....-:         .  ..--......:+%%%%%%+..............*:::::::::::*-      
    :#-=-.........:#%%%%%%%%*...:+.       .     .-=.....:#%%%%%%%%%.............:=:::::::::::#:     
   .*=-*.........:#%%%%%%%%%#+..+..             .:-....:+%%%%%%%%%%*.............*-::::::::::-#.    
  .=*-+=.........=#%%%%#%%%%%*..+.              ..=:...-%%%%%*#%%%%#.............==:::::::::::++    
  :*=:*:.........*%%%%+.-#%%%*::=.              ..=-...-%%%%-.-#%%%#-............:=:::::::::::-*:   
..++-:#..........+%%%%+.-#%%%*::-. .         .....=-...=%%%%:.-#%%%#=............:=::::::::::::=+.  
 .*=::*:.........=#%%%##%%%%%*.:-..       . ......=-...-%%%%%+#%%%%#:............:=::::::::::::-+:  
.-*-::+-.........:#%%%%###%%%+..*..............::+*:...-#%%%####%%%#.............=-:::::::::::::+=. 
.=+:::-*..........=%%######%*...*+:::=-::::::::-*#=.....=%%###*###%:.............*::::::::::::::=+: 
.*=::::+-..........-%#***##*....:#*-:*=:::::-=**+*=......=##****#*:.............==::::::::::::::-*-.
.#-::::-+:...........=*#*+:......+++*##****+++++**........:-+#*+-...............+::::::::::::::::++.
:#::::::-+........................+==+++++++++++*..............................*:::::::::::::::::=*:
=*:::::::==........................=+=+++++++++*..............................+-:::::::::::::::::-#:
=*::::::::==........................=*+++++++#:.............................:=-::::::::::::::::::-#-
++:::::::::-*:........................-*##*=...............................-+:::::::::::::::::::::*=
++:::::::::::==:.........................--..............................:+-::::::::::::::::::::::*=
++:::::::::::::==-....................-==::==-.........................-+-:::::::::::::::::::::::-*+
=*:::::::::::::::-===:............-----:::::::====:................:===-:::::::::::::::::::::::::-*+
-#:::::::::::::::::::---==+++==----:::::::::::::::--=====-:::-=++==-::::::::::::::::::::::::::::-=*=
.#:::::::::::::::::::::::::::::::::::::::::::::::::::::::-----::::::::::::::::::::::::::::::::--==#-
.*=:::::::::::::::::::::::::::--:::::::::::::::::::--=+++=-::::::::::::::::::::::::::::::::::-====#:
.=*::::::::::::::::::::-=*#*+=====+#*-::::::::-+#*++++++++++##=:::::::::::::::::::::::::::--=====+#:
 :+-::::::::::::::::-+*+===========++*#=::::=#*++++++++++++++++**=:::::::::::::::::::::---=======*+.
 .=+::::-:::::::::-**+=============++++##--+#*++++++++++++++++++++#=::::::::::::-=---============*-.
  :+=-----::::::-+*++++===========+++++**%*#**++++++++++++++++++++++*=--------==+===============+*:.
  .=+=====-----=*++++++++++++++++++*++++**#***+++****++++++++++++++++*+=========*===============*=. 
   .++==+*=====**+++++++++++++++++++***#******#****++++++++++++++++++**========#+==============+*:  
   ..*===++=====**++++++++++++++++++++++******++++++++++++++++++++++**========+#===============*=.  
     .%===*+=====+#*+++++++++++++++++++***%#**+++++++++++++++++++++%==========%*==============+*.   
      .%===*========%*++++++++++++++++***#+*#**+++++++++++++++++*#-%=========##+==============%.  . 
       :#+==*=======*-+#*++++++++++++**#*---=#**+++++++++++++**+---#=======+*=#+========+===+%:     
        :*+==#+=====#----=************=--------+**+++*******=------=+=====**--#+=======+===+%:      
    .    .++==+**++*=-----------------------------------------------+*++**----*=======+*==+*:       
   .      .=#===++=---------------------------------------------------==------#=======#==*+.        
     .      .+#==*=-----------------------------------------------------------*=====+#=+#-.         
    .    .   ..+*=*=----------------------------------------------------------*====+**#-..          
              ...=#*#---------------------------------------------------------*+==#%#-.          .. 
                   .*%+-------------------------------------------------------+@%%=.                
         .           .:**=--------------------==----------------------------=*+.                    
        .            ..-+#%*==------------------++=----------------------=+#=.                      
                ..  .+#*******#*++==-----==++*##**##*++==-----------=++*#**#*:.                     
                   -#++++*********************##*-.  ..:-=#******************#-.        .           
       .          -#====++**#*+*****++****##*-..        .**++*******+***++++***.                    
              .  :#======+*%+=+++******##=:.            -+==+**********++++++*#:   .      .         
                .=*======+%*====+****%*..               -+==+*****#%%#*+++++++#:          .         
                .++===*%#:#+=====+*%=.                  :+==****##:  .=#*++++*#:                    
                 +*##=.  .*+====+%:                     .#+=**##-.      .**++#+.                    
                  ..      -%=+**.      .             .   :*+##:.          :*#*:.                    
   .                      .+#=.                           =#:..   .        ....            .     .  
'

echo "COOKOOO COOKOOO!!"

if command -v apt &>/dev/null; then
  echo "Debian-based system detected. Installing dependencies using apt..."
  sudo apt update && sudo apt install -y \
    curl \
    wget \
    zsh \
    neofetch \
    libfuse2 \
    tmux \
    git
elif command -v dnf &>/dev/null; then
  echo "Fedora-based system detected. Installing dependencies using dnf..."
  sudo dnf install -y \
    curl \
    wget \
    zsh \
    neofetch \
    libfuse2 \
    tmux \
    git
else
  echo "Unsupported package manager. Please install dependencies manually."
  exit 1
fi


echo "Installing Node packages..."
echo "Installing NVM..."
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash

echo "Sourcing NVM..."
echo 'export NVIM_DIR="$HOME/.nvm"' >> ~/.bashrc
echo '[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"' >> ~/.bashrc
echo '[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"' >> ~/.bashrc
\. "$HOME/.nvm/nvm.sh"

echo "Installing NVM..."
nvm install 22

echo "Verifying Packages..."
node -v 
nvm current 

echo "Verifying npm..."
npm -v 

echo "Enabling Corepack for pnpm..."
corepack enable pnpm

echo "Verifying pnpm..."
pnpm -v

echo "Installing Neovim..."
curl -LO https://github.com/neovim/neovim/releases/latest/download/nvim-linux-x86_64.appimage
chmod u+x nvim-linux-x86_64.appimage
./nvim-linux-x86_64.appimage

echo "Exposing Neovim Globally..."
sudo mkdir -p /opt/nvim
sudo mv nvim-linux-x86_64.appimage /opt/nvim/nvim

echo "Sourcing Neovim..."
echo 'export PATH="$PATH:/opt/nvim/"' >> ~/.bashrc

echo "Now you can officially say Neovim BTW"

echo "Putting all $PATH into ~/.zshrc..."
echo '[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"' >> ~/.zshrc
echo 'export PATH="$PATH:/opt/nvim/"' >> ~/.zshrc

echo "Installing OhMyZsh..."
sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"

echo "You are set and good to go"
echo "If you want to change to zsh"
echo "Just run: chsh -s $(which zsh)"
